__d(function(_g,_r,_i,_a,m,_e,d){"use strict";Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,"CrossAppAuthScreen",{enumerable:!0,get:function(){return i}}),Object.defineProperty(_e,"CrossAppAuthScreenView",{enumerable:!0,get:function(){return u}}),Object.defineProperty(_e,"default",{enumerable:!0,get:function(){return i}});var e=_r(d[0]),t=_r(d[1]),r=_r(d[2]),a=_r(d[3]),o=_r(d[4]),n=_r(d[5]),s=_r(d[6]),c=_r(d[7]),l=_r(d[8]);_r(d[9]),_r(d[10]),_r(d[11]),_r(d[12]),_r(d[13]),_r(d[14]),_r(d[15]),_r(d[16]),_r(d[17]),_r(d[18]),_r(d[19]),_r(d[20]),_r(d[21]),_r(d[22]),_r(d[23]),_r(d[24]),_r(d[25]),_r(d[26]),_r(d[27]),_r(d[28]),_r(d[29]),_r(d[30]),_r(d[31]),_r(d[32]),_r(d[33]),_r(d[34]),_r(d[35]),_r(d[36]),_r(d[37]),_r(d[38]),_r(d[39]),_r(d[40]),_r(d[41]),_r(d[42]),_r(d[43]),_r(d[44]),_r(d[45]),_r(d[46]),_r(d[47]),_r(d[48]),_r(d[49]);const u=({providerApp:r,success:a,error:o,onClose:n})=>{let{title:s,subtitle:c}=(0,t.useMemo)(()=>a?{title:`Successfully connected with ${r.name}`,subtitle:"You're good to go!"}:o?{title:"Authentication failed",subtitle:o.message}:{title:`Connecting to ${r.name}`,subtitle:`Please check the pop-up from ${r.name} to continue`},[a,o,r.name]);return(0,e.jsx)(l.S,{title:s,subtitle:c,icon:r.logoUrl,iconVariant:"loading",iconLoadingStatus:{success:a,fail:!!o},onBack:n,watermark:!0})},i={component:()=>{let l=(0,r.u)(),{data:i,navigate:p,setModalData:f,onUserCloseViaDialogOrKeybindRef:A}=(0,n.a)(),{crossAppAuthFlow:h,updateWallets:b,closePrivyModal:g,createAnalyticsEvent:y}=(0,o.u)(),{logout:S}=(0,s.z)(),[C,v]=(0,t.useState)({}),w=i?.crossAppAuth,T={id:w.appId,name:w.name,logoUrl:w.logoUrl},U=new o.a(`There was an issue connecting your ${T.name} account. Please try again.`),O=new a.R(async e=>{if(w.popup)try{let t=await h({appId:e,popup:w.popup,action:w.action});v({data:t})}catch(e){if(e instanceof o.a)v({error:e});else if(e instanceof o.e){if(e.privyErrorCode===o.b.ACCOUNT_TRANSFER_REQUIRED&&e.data?.data?.nonce)return f({accountTransfer:{nonce:e.data?.data?.nonce,account:e.data?.data?.subject,displayName:e.data?.data?.account?.displayName,linkMethod:`privy:${T.id}`,embeddedWalletAddress:e.data?.data?.otherUser?.embeddedWalletAddress,oAuthUserInfo:e.data?.data?.otherUser?.oAuthUserInfo}}),void p("LinkConflictScreen");w.popup&&w.popup.close(),v({error:U})}else v({error:U})}else v({error:U})}),_=()=>{C.data&&(b(),w.onSuccess(C.data),g({shouldCallAuthOnSuccess:!0,isSuccess:!0})),w.onError(C.error??new o.a("User canceled flow")),g({shouldCallAuthOnSuccess:!1,isSuccess:!1})};return A.current=_,(0,t.useEffect)(()=>{T.id.length&&O.execute(T.id)},[T.id]),(0,t.useEffect)(()=>{if(!C.data)return;let e=C.data;if(l.legal.requireUsersAcceptTerms&&!e.hasAcceptedTerms){let e=setTimeout(()=>{p("AffirmativeConsentScreen")},r.q);return()=>clearTimeout(e)}if((0,c.s)(e,l.embeddedWallets)){let e=setTimeout(()=>{f({createWallet:{onSuccess:()=>{},onFailure:e=>{console.error(e),y({eventName:"embedded_wallet_creation_failure_logout",payload:{error:e,provider:`privy:${T.id}`,screen:"CrossAppAuthScreen"}}),S()},callAuthOnSuccessOnClose:!0}}),p("EmbeddedWalletOnAccountCreateScreen")},r.q);return()=>clearTimeout(e)}let t=setTimeout(_,r.q);return()=>clearTimeout(t)},[C.data]),(0,e.jsx)(u,{providerApp:T,success:!!C.data,error:C.error,onClose:_})},isShownBeforeReady:!0}},4218,[16,14,1557,783,1559,1556,1564,4581,4572,784,1558,1358,819,1341,1594,1591,1595,1343,1654,1589,1160,1657,1660,1661,1592,1662,1568,1565,1663,1871,3739,943,1593,1560,1389,3741,787,3742,1374,3748,3894,3895,4573,4574,4575,4576,4577,4578,4579,4580]);