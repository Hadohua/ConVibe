__d(function(_g,r,_i,a,_m,_e,_d){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,"MfaEnrollmentFlowScreen",{enumerable:!0,get:function(){return C}}),Object.defineProperty(_e,"default",{enumerable:!0,get:function(){return C}});var n=r(_d[0]),t=e(r(_d[1])),o=e(r(_d[2])),s=e(r(_d[3])),l=e(r(_d[4])),i=r(_d[5]),c=r(_d[6]),d=r(_d[7]),u=r(_d[8]),h=r(_d[9]),m=r(_d[10]),x=r(_d[11]),f=r(_d[12]),j=r(_d[13]),y=e(r(_d[14])),p=e(r(_d[15])),v=r(_d[16]),w=r(_d[17]),g=r(_d[18]),S=r(_d[19]);r(_d[20]),r(_d[21]),r(_d[22]),r(_d[23]),r(_d[24]),r(_d[25]),r(_d[26]),r(_d[27]),r(_d[28]),r(_d[29]),r(_d[30]),r(_d[31]),r(_d[32]),r(_d[33]),r(_d[34]),r(_d[35]),r(_d[36]),r(_d[37]),r(_d[38]),r(_d[39]),r(_d[40]),r(_d[41]),r(_d[42]),r(_d[43]),r(_d[44]),r(_d[45]),r(_d[46]),r(_d[47]),r(_d[48]),r(_d[49]),r(_d[50]),r(_d[51]),r(_d[52]),r(_d[53]),r(_d[54]),r(_d[55]),r(_d[56]),r(_d[57]),r(_d[58]),r(_d[59]),r(_d[60]),r(_d[61]),r(_d[62]),r(_d[63]),r(_d[64]),r(_d[65]),r(_d[66]),r(_d[67]),r(_d[68]),r(_d[69]),r(_d[70]),r(_d[71]),r(_d[72]),r(_d[73]),r(_d[74]),r(_d[75]),r(_d[76]),r(_d[77]),r(_d[78]),r(_d[79]),r(_d[80]);const M=({appName:e,onComplete:t,onReset:o,onClose:s})=>{let[l,d]=(0,i.useState)(""),[m,j]=(0,i.useState)(!1),[M,C]=(0,i.useState)(null),[k,b]=(0,i.useState)("enroll"),{initEnrollmentWithSms:F,submitEnrollmentWithSms:E}=(0,f.d)(),{data:P}=(0,x.a)(),T=(0,h.u)();function B(){P?.mfaEnrollmentFlow?.onSuccess(),t()}return M?(0,n.jsx)(S.ErrorScreenView,{allowlistConfig:T.allowlistConfig,error:M,onBack:()=>C(null),onRetry:()=>C(null)}):(0,n.jsxs)(n.Fragment,"enroll"===k?{children:[(0,n.jsx)(u.M,{backFn:o,onClose:s},"header"),(0,n.jsx)(g.I,{style:{marginBottom:"1.5rem"},children:(0,n.jsx)(p.default,{})}),(0,n.jsx)(g.T,{children:"Set up SMS verification"}),(0,n.jsxs)(g.S,{children:["We'll text a verification code to this mobile device whenever you use your ",e," ","wallet."]}),(0,n.jsxs)(g.C,{children:[(0,n.jsx)(w.C,{onSubmit:async function({qualifiedPhoneNumber:e}){try{await F({phoneNumber:e}),d(e),b("verify")}catch(e){C(e)}},hideRecent:!0}),(0,n.jsxs)(g.a,{children:["By providing your mobile number, you agree to receive text messages from ",T?.name,". Some carrier charges may apply"]})]}),(0,n.jsx)(u.a,{})]}:m?{children:[(0,n.jsx)(u.M,{onClose:B},"header"),(0,n.jsx)(g.I,{style:{marginBottom:"1.5rem"},children:(0,n.jsx)(y.default,{})}),(0,n.jsx)(g.T,{children:"SMS verification added"}),(0,n.jsxs)(g.S,{children:["From now on, you'll enter the verification code sent to your mobile device whenever you use your ",e," wallet."]}),(0,n.jsx)(g.B,{children:(0,n.jsx)(c.P,{onClick:B,children:"Done"})}),(0,n.jsx)(u.a,{})]}:{children:[(0,n.jsx)(u.M,{backFn:function(){"verify"===k?b("enroll"):o()},onClose:s},"header"),(0,n.jsx)(g.I,{style:{marginBottom:"1.5rem"},children:(0,n.jsx)(p.default,{})}),(0,n.jsx)(g.T,{children:"Enter enrollment code"}),(0,n.jsxs)(g.C,{children:[(0,n.jsx)(g.N,{onChange:async function(e){try{if(!e)return;await E({phoneNumber:l,mfaCode:e}),j(!0)}catch(e){if((0,f.f)(e))throw Error("You have exceeded the maximum number of attempts. Please close this window and try again in 10 seconds.");if((0,f.g)(e))throw Error("The code you entered is not valid");if((0,f.h)(e))throw Error("You have exceeded the time limit for code entry. Please try again in 30 seconds.");throw(0,f.i)(e)?Error("Verification canceled"):Error("Unknown error")}}}),(0,n.jsxs)(g.S,{children:["To continue, enter the 6-digit code sent to ",(0,n.jsx)("strong",{children:(0,v.lastFourDigits)(l)})]})]}),(0,n.jsx)(u.a,{})]})},C={component:()=>{let{user:e,enrollInMfa:y,ready:p}=(0,x.u)(),[v,w]=(0,i.useState)(null),{unenrollWithSms:S,unenrollWithTotp:C,unenrollWithPasskey:k,submitEnrollmentWithTotp:b,initEnrollmentWithPasskey:F,submitEnrollmentWithPasskey:E,initEnrollmentWithTotp:P}=(0,f.d)(),{data:T,onUserCloseViaDialogOrKeybindRef:B}=(0,x.a)(),R=(0,h.u)(),{closePrivyModal:I}=(0,m.u)(),{promptMfa:W}=(0,f.u)(),[A,N]=(0,i.useState)(!1),[O,U]=(0,i.useState)(null),[L,_]=(0,i.useState)(null),D=()=>{I({shouldCallAuthOnSuccess:!0}),y(!1),setTimeout(()=>{w(null),U(null)},500)},[V,Y]=(0,i.useState)(!1),[$,q]=(0,i.useState)();B.current=D;let H=e?.mfaMethods.includes("sms"),K=!!e?.phone,z=e?.mfaMethods.includes("totp"),G=e?.mfaMethods.includes("passkey"),J=H||z||G,Q=e?.linkedAccounts.filter(e=>"passkey"===e.type).map(e=>e.credentialId)??[];function X(){w(null),U(null)}async function Z(e=Q){Y(!0);try{return await F(),await E({credentialIds:e},{removeForLogin:T?.mfaEnrollmentFlow?.shouldUnlinkOnUnenrollMfa}),T?.mfaEnrollmentFlow?.onSuccess(),D()}catch(e){q(e)}finally{Y(!1)}}if((0,i.useEffect)(()=>{J&&N(!0)},[J]),!p||!e||!R)return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.M,{onClose:D},"header"),(0,n.jsx)(g.A,{children:(0,n.jsx)(j.M,{})}),(0,n.jsx)(g.C,{children:(0,n.jsx)(d.L,{})}),(0,n.jsx)(u.a,{})]});if("sms"===v)return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.M,{backFn:X,onClose:D},"header"),(0,n.jsx)(g.I,{style:{marginBottom:"1.5rem"},children:(0,n.jsx)(t.default,{})}),(0,n.jsx)(g.T,{children:"Remove SMS verification?"}),(0,n.jsxs)(g.S,{children:["MFA adds an extra layer of security to your ",R?.name," account. Make sure you have other methods to secure your account."]}),(0,n.jsx)(g.B,{children:(0,n.jsx)(c.P,{$warn:!0,onClick:async function(){w(null);try{await S()}catch(e){w(null)}},children:"Remove"})}),(0,n.jsx)(u.a,{})]});if("totp"===v)return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.M,{backFn:X,onClose:D},"header"),(0,n.jsx)(g.I,{style:{marginBottom:"1.5rem"},children:(0,n.jsx)(t.default,{})}),(0,n.jsx)(g.T,{children:"Remove authenticator app verification?"}),(0,n.jsxs)(g.S,{children:["MFA adds an extra layer of security to your ",R?.name," account. Make sure you have other methods to secure your account."]}),(0,n.jsx)(g.B,{children:(0,n.jsx)(c.P,{$warn:!0,onClick:async function(){w(null);try{await C()}catch(e){w(null)}},children:"Remove"})}),(0,n.jsx)(u.a,{})]});if("passkey"===v){let e=T?.mfaEnrollmentFlow?.shouldUnlinkOnUnenrollMfa??!0;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.M,{backFn:X,onClose:D},"header"),(0,n.jsx)(g.I,{style:{marginBottom:"1.5rem"},children:(0,n.jsx)(t.default,{})}),(0,n.jsx)(g.T,{children:"Are you sure you want to remove this passkey?"}),(0,n.jsx)(g.S,{children:e?"Removing your passkey will remove as both a verification method and a login method.":"Removing your passkey will remove as a verification method."}),(0,n.jsx)(g.B,{children:(0,n.jsx)(c.P,{$warn:!0,onClick:async function(){w(null);try{await k({removeForLogin:T?.mfaEnrollmentFlow?.shouldUnlinkOnUnenrollMfa})}catch(e){w(null)}},children:"Remove"})}),(0,n.jsx)(u.a,{})]})}if(0===T.mfaEnrollmentFlow.mfaMethods.length&&!J)return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.M,{onClose:D},"header"),(0,n.jsx)(g.I,{style:{marginBottom:"1.5rem"},children:(0,n.jsx)(o.default,{})}),(0,n.jsx)(g.T,{children:"Add more security"}),(0,n.jsxs)(g.S,{children:[R?.name," does not have any verification methods enabled."]}),(0,n.jsx)(g.B,{children:(0,n.jsx)(c.P,{onClick:D,children:"Close"})}),(0,n.jsx)(u.a,{})]});let ee=!J&&!A;return ee?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.M,{onClose:D},"header"),(0,n.jsx)(g.I,{style:{marginBottom:"1.5rem"},children:(0,n.jsx)(o.default,{})}),(0,n.jsx)(g.T,{children:"Transaction Protection"}),(0,n.jsx)(g.S,{children:"Set up transaction protection to add an extra layer of security to your account"}),(0,n.jsxs)(g.L,{children:[(0,n.jsxs)(g.b,{children:[(0,n.jsx)(g.c,{children:(0,n.jsx)(s.default,{})}),"Enable 2-Step verification for your ",R?.name," wallet."]}),(0,n.jsxs)(g.b,{children:[(0,n.jsx)(g.c,{children:(0,n.jsx)(l.default,{})}),"You'll be prompted to authenticate to complete transactions."]})]}),(0,n.jsxs)(g.B,{children:[(0,n.jsx)(c.P,{onClick:()=>N(!0),children:"Continue"}),(0,n.jsx)(c.S,{onClick:D,children:"Not now"})]}),(0,n.jsx)(u.a,{})]}):"sms"===O?(0,n.jsx)(M,{appName:R?.name||"Privy",onComplete:D,onReset:X,onClose:D}):"totp"===O&&L?(0,n.jsx)(j.E,{onClose:D,onReset:X,submitEnrollmentWithTotp:({mfaCode:e})=>(async function(e){try{return q(void 0),await b({mfaCode:e}),T?.mfaEnrollmentFlow?.onSuccess(),D()}catch(e){q(e)}finally{w(null)}})(e),totpInfo:{...L,appName:R?.name||"Privy"}}):"passkey"===O?(0,n.jsx)(j.a,{onReset:X,onClose:D,submitEnrollmentWithPasskey:Z}):(0,n.jsx)(j.b,{showIntro:ee,userMfaMethods:e.mfaMethods,appMfaMethods:R.mfa.methods,userHasAuthSms:K,backFn:function(){N(!1)},handleSelectMethod:async function(e){try{await W()}catch(e){return void q(e)}return"totp"===e?(U(e),_(null),void P().then(e=>{_(e)}).catch(()=>{_(null),X()})):"passkey"===e&&1===Q.length?await Z():void U(e)},isTotpLoading:"totp"===O&&!L,isPasskeyLoading:V,error:$,onClose:D,setRemovingMfaMethod:async e=>{try{await W()}catch(e){return void q(e)}w(e)}})}}},5786,[5,5249,5771,5787,5788,3,5244,2523,5246,2509,2511,2508,2128,5772,5647,5682,2129,5699,5776,5736,6277,2524,2537,2539,2293,2540,792,1019,2621,2622,5247,5248,5250,2510,6275,2310,2164,2623,2295,2683,2686,2689,2690,2691,2692,2900,4618,2341,4620,2132,4621,2326,7827,4873,4874,5773,5774,5698,5775,5666,5662,5777,5778,5765,7957,5758,5243,5245,5251,5740,5583,5648,5779,5707,5663,5664,5669,5780,5584,5640,5654]);