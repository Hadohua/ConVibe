__d(function(g,_r,_i,_a,m,_e,d){"use strict";Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,"AwaitingEvmToSolBridgingScreen",{enumerable:!0,get:function(){return F}}),Object.defineProperty(_e,"default",{enumerable:!0,get:function(){return F}});var e,t=_r(d[0]),a=_r(d[1]),n=(e=a)&&e.__esModule?e:{default:e},i=_r(d[2]),s=_r(d[3]),r=_r(d[4]),o=_r(d[5]),c=_r(d[6]),l=_r(d[7]),u=_r(d[8]),h=_r(d[9]),f=_r(d[10]),p=_r(d[11]),v=_r(d[12]),b=_r(d[13]),T=_r(d[14]),S=_r(d[15]),I=_r(d[16]),w=_r(d[17]),y=_r(d[18]),C=_r(d[19]),x=_r(d[20]),E=_r(d[21]),N=_r(d[22]),A=_r(d[23]);_r(d[24]),_r(d[25]),_r(d[26]),_r(d[27]),_r(d[28]),_r(d[29]),_r(d[30]),_r(d[31]),_r(d[32]),_r(d[33]),_r(d[34]),_r(d[35]),_r(d[36]),_r(d[37]),_r(d[38]),_r(d[39]),_r(d[40]),_r(d[41]),_r(d[42]),_r(d[43]),_r(d[44]),_r(d[45]),_r(d[46]),_r(d[47]),_r(d[48]),_r(d[49]),_r(d[50]),_r(d[51]),_r(d[52]),_r(d[53]),_r(d[54]),_r(d[55]),_r(d[56]),_r(d[57]),_r(d[58]),_r(d[59]),_r(d[60]),_r(d[61]),_r(d[62]),_r(d[63]),_r(d[64]),_r(d[65]),_r(d[66]),_r(d[67]),_r(d[68]),_r(d[69]),_r(d[70]),_r(d[71]),_r(d[72]),_r(d[73]),_r(d[74]),_r(d[75]),_r(d[76]),_r(d[77]),_r(d[78]);const F={component:()=>{let e=(0,f.u)(),{rpcConfig:a,appId:F,closePrivyModal:U,createAnalyticsEvent:j}=(0,p.u)(),{navigate:B,setModalData:P,data:O}=(0,b.a)(),_=(0,f.u)(),{wallets:k}=(0,S.u)(),[D,L]=(0,i.useState)(null),[M,q]=(0,i.useState)(null),[W,H]=(0,i.useState)([]),[R,$]=(0,i.useState)(0),[Q,V]=(0,i.useState)(!1),[z,Y]=(0,i.useState)(!1),[G,J]=(0,i.useState)(!1),[K,X]=(0,i.useState)(!1),[Z,ee]=(0,i.useState)(),[te,ae]=(0,i.useState)();if(!O?.funding||"solana"!==O.funding.chainType)throw Error("Invalid funding data");let{address:ne,chain:ie,connectedWallet:se}=O.funding,[re,oe]=(0,i.useState)(O.funding.amount),de=("ethereum"===se?.type?se:void 0)??k[0],ce=(0,v.Q)(de?.walletClientType||"unknown"),le=ce?.name||"wallet",[ue,he]=(0,i.useState)(null);(0,i.useEffect)(()=>{(async()=>{if(!de)return;let e=await de.getEthereumProvider();he((0,s.createWalletClient)({account:de.address,transport:(0,s.custom)(e)}).extend(s.publicActions))})().catch(console.error)},[de]);let[ge,fe]=(0,i.useState)(0n),pe=(0,x.g)(ge);(0,i.useEffect)(()=>{let t=e.solanaRpcs[ie];t?(0,y.z)({rpc:t.rpc,address:ne}).then(e=>fe(BigInt(e))).catch(console.error):console.warn("Unable to load solana rpc, skipping balance")},[]);let[ve,me]=(0,i.useState)(),{tokenPrice:be}=(0,T.u)("solana"),{fundingAmountInBaseUnit:Te,fundingAmountInUsd:Se}=(0,x.a)({amount:re,fee:0n,tokenPrice:be,isUsdc:O.funding.isUSDC});if((0,i.useEffect)(()=>{(async()=>{if(!ue||!de)return;let e=["solana:testnet","solana:devnet"].includes(ie);e&&console.warn("Solana testnets are not supported for bridging");let t=(0,r.addToDefaultChains)(_.chains).filter(({testnet:t})=>!!t===e),n=(await(0,E.g)({chains:t,address:de.address,appId:F,rpcConfig:a})).filter(e=>e.balance>0n);if(n.length<1)return void L(new p.a(`Wallet ${(0,v.D)(de.address)} does not have enough funds.`,void 0,p.b.INSUFFICIENT_BALANCE));n.sort((e,t)=>Number(t.balance-e.balance));let i=(await Promise.allSettled(n.map(async e=>({...e,quote:await(0,w.g)({isTestnet:!1,input:(0,w.t)({appId:F,amount:Te.toString(),user:de.address,recipient:ne,destinationChainId:w.b,destinationCurrency:w.a,originChainId:e.chain.id})})})))).filter(e=>"fulfilled"===e.status).map(e=>e.value);if(i.length<1)return void L(new p.a(`Unable to fetch quotes for bridging. Wallet ${(0,v.D)(de.address)} does not have enough funds.`,void 0,p.b.INSUFFICIENT_BALANCE));let s=i.map(({quote:e,balance:t,chain:a})=>({bridgeTx:(0,w.c)(e),balance:t,chain:a,isErc20Quote:!1})).filter(({bridgeTx:e})=>!!e);if(s.length>1)return void H(s);let o=s.at(0);o?(Y(!0),me({data:o.bridgeTx.data,to:o.bridgeTx.to,value:o.bridgeTx.value,chain:o.chain})):L(new p.a(`Unable to select bridge option from quotes. Wallet ${(0,v.D)(de.address)} does not have enough funds.`,void 0,p.b.INSUFFICIENT_BALANCE))})().catch(console.error)},[ue]),(0,i.useEffect)(()=>{(async()=>{let e,t;if(!ue||!de||Q||G||!ve)return;V(!0);let n=(0,s.createPublicClient)({chain:ve.chain,transport:(0,s.http)((0,N.a)(ve.chain,a,F))});try{e=await n.prepareTransactionRequest({account:de.address,to:ve.to,chain:ve.chain,data:ve.data,value:BigInt(ve.value??0)})}catch(e){console.error(e),W.length>1&&q(e.shortMessage??"Something went wrong")}if(e){V(!1),J(!0);try{await ue.switchChain({id:ve.chain.id})}catch(e){await ue.addChain({chain:ve.chain}),await ue.switchChain({id:ve.chain.id})}try{t=await ue.sendTransaction(e)}catch(e){console.error(e),"TransactionExecutionError"===e.name&&(W.length<1?L(new p.a(e.shortMessage,void 0,p.b.TRANSACTION_FAILURE)):q(e.shortMessage??"Something went wrong"))}if(t)return await ue.waitForTransactionReceipt({hash:t}),z?(ae("pending"),void ee(t)):(J(!1),X(!0),void j({eventName:I.O,payload:{provider:"external",status:"success",txHash:t,address:de.address,chainId:ve.chain.id,chainType:"ethereum",value:ve.value?(0,s.formatUnits)(BigInt(ve.value),18):void 0,token:"ETH",destination:ne,destinationClusterName:"mainnet-beta",destinationChainType:"solana",destinationValue:(0,s.formatUnits)(Te,9),destinationToken:"SOL"}}));J(!1)}else V(!1)})().catch(console.error)},[ue,ve]),(0,w.u)({transactionHash:Z,isTestnet:!1,bridgingStatus:te,setBridgingStatus:ae,onSuccess({transactionHash:e}){Y(!1),X(!0),j({eventName:I.O,payload:{provider:"external",status:"success",txHash:e,address:de?.address,chainId:ve?.chain.id,chainType:"ethereum",value:ve?.value?(0,s.formatUnits)(BigInt(ve.value),18):void 0,token:"ETH",destination:ne,destinationClusterName:"mainnet-beta",destinationChainType:"solana",destinationValue:(0,s.formatUnits)(Te,9),destinationToken:"SOL"}})},onFailure({error:e}){Y(!1),L(e)}}),(0,i.useEffect)(()=>{D&&(P({funding:O?.funding,solanaFundingData:O?.solanaFundingData,sendTransaction:O?.sendTransaction,errorModalData:{error:D,previousScreen:"TransferFromWalletScreen"}}),B("ErrorScreen",!1))},[D]),(0,i.useEffect)(()=>{if(!K)return;let e=setTimeout(U,f.t);return()=>clearTimeout(e)},[K]),K)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.t,{}),(0,t.jsx)(o.b,{}),(0,t.jsxs)(o.c,{children:[(0,t.jsx)(n.default,{color:"var(--privy-color-success)",width:"64px",height:"64px"}),(0,t.jsx)(l.C,{title:"Success!",description:`You\u2019ve successfully added ${re} SOL to your ${_.name} wallet. It may take a minute before the funds are available to use.`})]}),(0,t.jsx)(o.R,{}),(0,t.jsx)(c.B,{})]});let Ie=W[R];return W.length>1&&Ie?(0,t.jsx)(E.B,{displayName:le,configuredFundingChain:ie,formattedBalance:pe,fundingAmount:re,fundingCurrency:"SOL",fundingAmountInUsd:Se,options:W,selectedOption:Ie,isPreparing:Q,isSubmitting:G,addressToFund:ne,fundingWalletAddress:de?.address||"",errorMessage:M,onSubmit:()=>{O.funding?.amount!==re?(async function(){if(de&&Ie)try{let e=await(0,w.g)({isTestnet:!1,input:(0,w.t)({appId:F,amount:Te.toString(),user:de.address,recipient:ne,destinationChainId:w.b,destinationCurrency:w.a,originChainId:Ie.chain.id})}),t=(0,w.c)(e);if(!t)throw Error("Invalid transaction request");Y(!0),me({data:t.data,to:t.to,value:t.value,chain:Ie.chain})}catch(e){console.error(e),L(new p.a("Unable to fetch quotes for bridging",e,p.b.INSUFFICIENT_BALANCE))}})().catch(console.error):me({to:Ie.bridgeTx.to,data:Ie.bridgeTx.data,value:Ie.bridgeTx.value,chain:Ie.chain})},onSelect:e=>{e!==R&&(q(null),$(e))},onAmountChange:oe}):G&&de?(0,t.jsx)(A.T,{walletClientType:de?.walletClientType||"unknown",displayName:le,addressToFund:ne,isBridging:z,isErc20Flow:!1,chainId:"solana",chainName:(0,C.g)(ie),totalPriceInUsd:void 0,totalPriceInNativeCurrency:void 0,gasPriceInUsd:void 0,gasPriceInNativeCurrency:void 0}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.t,{}),(0,t.jsx)(h.N,{}),(0,t.jsx)("div",{style:{marginTop:"1rem"}}),(0,t.jsx)(c.B,{})]})}}},5646,[5,5647,3,792,2129,5648,5246,5649,5650,5251,2509,2511,2523,2508,5651,2622,5653,5654,2128,5655,5656,5658,2621,5674,6277,5247,5248,5249,5250,2510,6275,2524,2537,2539,2293,2540,1019,5652,2310,2164,2623,2295,2683,2686,2689,2690,2691,2692,2900,4618,2341,4620,2132,4621,2326,7827,4873,4874,5657,5659,5244,5660,5643,5661,5662,5663,5664,5665,5666,5667,5668,5669,5670,5671,5672,5673,5675,5676,7957]);