__d(function(_g,_r,_i,a,m,_e,d){"use strict";Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,"TelegramAuthScreen",{enumerable:!0,get:function(){return g}}),Object.defineProperty(_e,"TelegramAuthScreenView",{enumerable:!0,get:function(){return u}}),Object.defineProperty(_e,"default",{enumerable:!0,get:function(){return g}});var e=_r(d[0]),t=_r(d[1]),r=_r(d[2]),n=_r(d[3]),o=_r(d[4]),i=_r(d[5]),l=_r(d[6]),c=_r(d[7]),s=_r(d[8]);_r(d[9]),_r(d[10]),_r(d[11]),_r(d[12]),_r(d[13]),_r(d[14]),_r(d[15]),_r(d[16]),_r(d[17]),_r(d[18]),_r(d[19]),_r(d[20]),_r(d[21]),_r(d[22]),_r(d[23]),_r(d[24]),_r(d[25]),_r(d[26]),_r(d[27]),_r(d[28]),_r(d[29]),_r(d[30]),_r(d[31]),_r(d[32]),_r(d[33]),_r(d[34]),_r(d[35]),_r(d[36]),_r(d[37]),_r(d[38]),_r(d[39]),_r(d[40]),_r(d[41]),_r(d[42]),_r(d[43]),_r(d[44]),_r(d[45]),_r(d[46]),_r(d[47]),_r(d[48]),_r(d[49]),_r(d[50]);const u=({success:t,errorMessage:r,onRetry:n})=>{let o=t?"Successfully connected with Telegram":r?r.message:"Verifying connection to Telegram";return(0,e.jsx)(c.S,{title:o,subtitle:t?"You're good to go!":r?r.detail:"Just a few moments more",icon:s.T,iconVariant:"loading",iconLoadingStatus:{success:t,fail:!!r},secondaryCta:r?.retryable&&n?{label:"Retry",onClick:n}:void 0,watermark:!0})},g={component:()=>{let{authenticated:c,logout:s,ready:g,user:f}=(0,i.u)(),{setModalData:y,navigate:b,resetNavigation:A,data:T}=(0,i.a)(),h=(0,n.u)(),{initLoginWithTelegram:S,loginWithTelegram:v,updateWallets:p,setReadyToTrue:E,closePrivyModal:R,createAnalyticsEvent:C,getAuthMeta:_}=(0,o.u)(),[w,O]=(0,t.useState)(!1),[W,L]=(0,t.useState)(void 0),M=(0,r.a)();async function j(){try{let e=await(async function(){let e;if(!c){if(M.enabled&&"error"===M.status)throw new r.C(M.error,null,o.b.CAPTCHA_FAILURE);return M.enabled&&"success"!==M.status&&(M.execute(),e=await M.waitForResult()),e}})();await v({captchaToken:e}),O(!0),E(!0)}catch(e){if(e?.privyErrorCode===o.b.ALLOWLIST_REJECTED)return L(void 0),A(),void b("AllowlistRejectionScreen");if(e?.privyErrorCode===o.b.USER_LIMIT_REACHED)return console.error(new o.k(e).toString()),L(void 0),A(),void b("UserLimitReachedScreen");if(e?.privyErrorCode===o.b.USER_DOES_NOT_EXIST)return L(void 0),A(),void b("AccountNotFoundScreen");if(e?.privyErrorCode===o.b.ACCOUNT_TRANSFER_REQUIRED&&e.data?.data?.nonce)return L(void 0),A(),y({accountTransfer:{nonce:e.data?.data?.nonce,account:e.data?.data?.subject,telegramAuthResult:_()?.telegramAuthResult,telegramWebAppData:_()?.telegramWebAppData,displayName:e.data?.data?.account?.displayName,linkMethod:"telegram",embeddedWalletAddress:e.data?.data?.otherUser?.embeddedWalletAddress}}),void b("LinkConflictScreen");let{retryable:t,detail:n}=(0,r.q)(e);L({retryable:t,detail:n,message:"Authentication failed"})}}return(0,t.useEffect)(()=>{j()},[]),(0,t.useEffect)(()=>{if(!(g&&c&&w&&f))return;if(h?.legal.requireUsersAcceptTerms&&!f.hasAcceptedTerms){let e=setTimeout(()=>{b("AffirmativeConsentScreen")},n.q);return()=>clearTimeout(e)}if((0,l.s)(f,h.embeddedWallets)){let e=setTimeout(()=>{y({createWallet:{onSuccess:()=>{},onFailure:e=>{console.error(e),C({eventName:"embedded_wallet_creation_failure_logout",payload:{error:e,provider:"telegram",screen:"TelegramAuthScreen"}}),s()},callAuthOnSuccessOnClose:!0}}),b("EmbeddedWalletOnAccountCreateScreen")},n.q);return()=>clearTimeout(e)}p();let e=setTimeout(()=>R({shouldCallAuthOnSuccess:!0,isSuccess:!0}),n.q);return()=>clearTimeout(e)},[g,c,w,f]),(0,e.jsx)(u,{success:w,errorMessage:W,onRetry:W?.retryable?async()=>{try{L(void 0),T?.telegramAuthModalData?.seamlessAuth||await S(void 0,T?.login?.disableSignup),await j()}catch(e){let{retryable:t,detail:n}=(0,r.q)(e);L({retryable:t,detail:n,message:"Authentication failed"})}}:void 0})},isCaptchaRequired:!0,isShownBeforeReady:!0}},4257,[16,14,783,1557,1559,1556,4581,4572,4637,784,1358,819,1341,1564,1565,1568,1589,1591,1592,943,1160,1593,1594,1595,1343,1654,1657,1660,1661,1662,1663,1871,3739,1560,1389,3741,787,3742,1374,3748,3894,3895,1558,4573,4574,4575,4576,4577,4578,4579,4580]);