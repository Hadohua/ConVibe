__d(function(_g,r,i,a,m,_e,_d){"use strict";Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,"MfaAuthVerifyFlowScreen",{enumerable:!0,get:function(){return n}}),Object.defineProperty(_e,"default",{enumerable:!0,get:function(){return n}});var e=r(_d[0]),t=r(_d[1]),o=r(_d[2]),s=r(_d[3]);r(_d[4]),r(_d[5]),r(_d[6]),r(_d[7]),r(_d[8]),r(_d[9]),r(_d[10]),r(_d[11]),r(_d[12]),r(_d[13]),r(_d[14]),r(_d[15]),r(_d[16]),r(_d[17]),r(_d[18]),r(_d[19]),r(_d[20]),r(_d[21]),r(_d[22]),r(_d[23]),r(_d[24]),r(_d[25]),r(_d[26]),r(_d[27]),r(_d[28]),r(_d[29]),r(_d[30]),r(_d[31]),r(_d[32]),r(_d[33]),r(_d[34]),r(_d[35]),r(_d[36]),r(_d[37]),r(_d[38]),r(_d[39]),r(_d[40]),r(_d[41]),r(_d[42]),r(_d[43]),r(_d[44]),r(_d[45]),r(_d[46]),r(_d[47]),r(_d[48]),r(_d[49]),r(_d[50]),r(_d[51]),r(_d[52]),r(_d[53]),r(_d[54]),r(_d[55]),r(_d[56]),r(_d[57]),r(_d[58]),r(_d[59]),r(_d[60]),r(_d[61]),r(_d[62]),r(_d[63]),r(_d[64]),r(_d[65]),r(_d[66]);const n={component:()=>{let{user:n}=(0,o.u)(),{data:c}=(0,o.a)(),[f,l]=(0,t.useState)(n?.mfaMethods[0]),[u,d]=(0,t.useState)(!1),[h,y]=(0,t.useState)(),[p,v]=(0,t.useState)();if((0,t.useEffect)(()=>{l(n?.mfaMethods[0])},[n?.mfaMethods]),!c?.mfaVerify)throw Error("Missing modal data for MFA verification screen.");let{onFailure:g,onSuccess:k,generateOptions:w,verifyTotpCode:S,verifyPasskey:M,verifySmsCode:b,sendSmsCode:C}=c.mfaVerify,E=async e=>{if("passkey"!==e)try{l(e),"sms"===e&&(l(e),await C()),"totp"===e&&l(e)}catch(e){console.error(e)}else try{l(e);let t=await w();if(!t)throw Error("something went wrong");y(t),await M(t),d(!0),v(void 0),k()}catch(e){v((0,s.t)(e))}},j=async e=>{v(void 0);try{if(!e||!f)return;if("passkey"===f){if(!h)throw Error("Missing passkey challenge");await M(h)}else"sms"===f?await b(e):"totp"===f&&await S(e);v(void 0),d(!0),k()}catch(e){throw(0,s.t)(e).error}},A=()=>{p||!u?g(p?.error??Error("Canceled MFA verification.")):k()},B=(0,t.useRef)(!1);return(0,t.useEffect)(()=>{!B.current&&f&&(B.current=!0,E(f).finally(()=>{B.current=!1}))},[open]),n?"passkey"===f?(0,e.jsx)(s.V,{account:n.linkedAccounts.filter(e=>"passkey"===e.type&&e.enrolledInMfa).sort((e,t)=>t.firstVerifiedAt.valueOf()-e.firstVerifiedAt.valueOf())[0],submitSuccess:u,hasBlockingError:p?.isBlocking??!1,error:p?.error,onClose:A,onBack:()=>{l(void 0),v(void 0)},handleSubmit:()=>j(h).catch(v)}):"sms"===f||"totp"===f?(0,e.jsx)(s.a,{selectedMethod:f,submitSuccess:u,hasBlockingError:p?.isBlocking??!1,handleSubmitCode:j,onClose:A,onBack:n.mfaMethods.length>1?()=>l(void 0):void 0}):(0,e.jsx)(s.b,{user:n,onSelect:E,handleClose:A}):null}}},4244,[16,14,1556,4687,943,1557,784,1558,1559,1560,4681,4633,4625,4677,4575,1568,4576,4577,4578,4579,4572,4573,1564,1565,1589,1591,1341,1592,1160,1593,1594,4574,4580,4679,4688,4642,4674,4596,4603,783,1358,819,1595,1343,1654,1657,1660,1661,1662,1663,1871,3739,1389,3741,787,3742,1374,3748,3894,3895,4689,4690,4618,4604,4600,4593,4616]);